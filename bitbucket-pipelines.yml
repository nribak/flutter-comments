image: instrumentisto/flutter:latest
pipelines:
  branches:
    solution:
      - step:
          name: "APK build"
          caches:
            - gradle
          script:
            - flutter pub get
            - echo "building..."
            - flutter build apk --release
          artifacts:
            - build/app/outputs/apk/**
      - step:
          name: "APK deploy to Google Cloud Storage"
          script:
            - pipe: atlassian/google-app-engine-deploy:0.2.1
              variables:
                KEY_FILE: ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAicm9vdC0zOTc4MDkiLAogICJwcml2YXRlX2tleV9pZCI6ICIzYmM4Y2M3OWQxODMwNGUyNTA5MjFlNWM0ZGJhNGYzMzMyNmRhNDYzIiwKICAicHJpdmF0ZV9rZXkiOiAiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdlFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLY3dnZ1NqQWdFQUFvSUJBUUN6WUtKRHhlNTNDaHlVXG5nSzd2eTgxYzJ2ZFBnZ1RUSzFrMzlrRDFvWDlkSzlLU25lOSs5Sk4xYmdhMFRaWERCbE94ZnVSOWVSWENRbVNKXG5VYzhHMVBFSDFxN1hQNndjV2R4elNXb0lBWlVhamxscnhRQVhuZ3d5ZXB6WmVlOWVlSk5rQjJZS292QzdFVGRzXG5kdUdFbW92cVBRcXBzaGNoK0ZHZTdlVW5yVElvWW5XNDg5dkhuZzBVdVNId1MweCtiazFtUWhPYmN4dGVvQzdWXG42STlyTzFaUUtOME9zcXVlRzlCTSszVG9wSzM3RWs1OWFvMzJpd1VTMk9nQjNUY3Y4WWhPRlhRYWlMTjd6VFNRXG5VdTBhanVBekQvUDRXTFVnejNmK0tabzVHMWVzZkRJWWdrdjB3VzhONHlJdHdacDA3TGh0MTF3T0VhUlNTeko2XG5xbG5NVmp6TEFnTUJBQUVDZ2dFQUcrR0F4eXo4T0VkN2tyOS9zV2tKbGcyNDFBUmZFSjJUeEFXRUtrbThYTFNEXG5pZU4vaHNtb0krQUNyY0xEYk9sT1YrL2p2dmJ6b1ZxbGVzeWE4N0prZG5YeGZpWjQ3MzB1TFVNemRtUWNrMkNkXG4ySWpwejBIekhtTjlmcllidFNEanMvQU1kY25HeGlUU2F3cjlXWm1WOXNZZklxbzZPejc0SE01WVNIYjhyVmNCXG51c0N2MGxMSE5LRHZqMFM1YklDVDNIUkx4SWhFT21XYktsSEVQWWViUDZDY1RvaEFoRlVNK1kwWlRWYm1vOW1HXG40WTB0NE94QjRyclQwR1drNldqT3UzUExpaGdjRVVCQ2Q5T3VnVWRFWHJ1UUZ6Y0FzaFJyWUVJQ3NkSEQ0U0puXG5ZTUtDL2thQ1FkeHUrcFlQNU40aWtxQVg1Qm5pQjVNQVFuaWpTYmphRFFLQmdRRGtPQitNcFhYRWpvSGM5Y2llXG5LWHFhcGRlVWNuUDZCZ1BUVXVaaXR4WkROaWZWdUFUaSs2VFFCK050STEweERqSjY0RWRWTStvTk90U3FncGlyXG52K21ucXJTWk1kWWlNRkU1QVZYZmNNVTJFRnNXOWJ0czIwckJoWkE0QkRVc3BlQlQzRE12Z0hybGEwdmZUVENEXG5Fd0FUenl0SHMrUzdXN3RJd2NBdmhacUJ4UUtCZ1FESk5uc0F6N3liaGRLamxJaDRDdVBVemNHOEJSaCtaenFSXG43RUtWcTNEUU9LZTU2d1BPazNqcWQwZDdZRXZzbHdXSHcvMHpKMGEyd1FxTURVeGd2UG93bitXZnZYZkxRRXJyXG52SGp1QmlBNXdzNmdtYU42dTY3U1JrQmVwNk1XYnVqQnk1OS85RkhJZDNYMEp5V2hZVmg3b3YyWHE4VVczZFVLXG5jYWhRaXM5OVR3S0JnREJMeERseVpuckRJYTVPQVRlZlZZZldvc21TY3dLdE5UQUtjaURmMkFFL082elp0WWNIXG5jL2htUXZXOHJ5TUxleGxQenlpenhNc3A4UWxvZThDVTYzQ0ZDcFVFMitqK1NxSUNxMWFPdWQxWUZyN0VIL2JJXG5iWWlJcUYyQ1huSmxaQlM3RzhYb3JabFJYSXdUL0xrd1V5cmVBNjIzM3liYkljWWk0blhzRXlkMUFvR0JBSUdNXG5QU2VwbUdKOWg3L2dPdmttOGNjcWJvaXlzekYzSHlPaWZNQkdjRXp2blRXN2xXamtWQjZKaTVGb3o1bFZKcTloXG54Vnl3OWZ0bVVIY1pmTXB3QVpsYTZZbXVnRGx4Zkl0SWZvZXBsQWY4WC9MUTJJdUYyU256SnpDS09CdVNidk9QXG5PWE0xaDQ1Tk03bHRsdkhQYmh1ME5oZjM5TjRqRnk0eFBWQVYvejlMQW9HQVhhSTBWTmIzcSt1U0ZCSUFSeUwzXG5ZWXl4dENoV1hBaC9GQVM0Smo5RkY2T2FqcDNDaC8wU1gvRThBd2xpRFpMbXA5ZlUxRGYwdVB6UmpVaThpcG43XG5mN2dyVE1Za3F2NVVGbTU0TmNmbGVjU0cvZlRsVzlza2tCc2p6STNOY2FYanpPeEhEamQ1VnhseFFqZWIvOURvXG5IVHNRYnljb2htWDZiNE9ZWmdpSmlWMD1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsCiAgImNsaWVudF9lbWFpbCI6ICJwaXBsaW5lLWFjY291bnRAcm9vdC0zOTc4MDkuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTE1MDc0NzU2OTc1NjMyODY4NTk0IiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4iLAogICJhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwKICAiY2xpZW50X3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9waXBsaW5lLWFjY291bnQlNDByb290LTM5NzgwOS5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgInVuaXZlcnNlX2RvbWFpbiI6ICJnb29nbGVhcGlzLmNvbSIKfQo=
                PROJECT: 'root-397809'
